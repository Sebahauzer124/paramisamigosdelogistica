<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Descarga de Datos CloudFleet</title>
    <style>
        body { font-family: Arial; background: #f0f0f0; padding: 20px; }
        button { margin: 10px; padding: 10px 20px; font-size: 16px; }
        input[type="date"] { font-size: 16px; padding: 5px; }
        #log { margin-top: 20px; background: #fff; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>

    <h1>Exportación desde CloudFleet</h1>

    <button onclick="ejecutar('combustible')">Descargar Vehículos (combustible.js)</button>

    <h3>Exportar Checklists</h3>
    <label>Fecha única:</label>
    <input type="date" id="fechaChecklist">
    <br><br>
    <label>O bien Rango de fechas:</label><br>
    Desde: <input type="date" id="fechaDesde">
    Hasta: <input type="date" id="fechaHasta">
    <br>
    <button onclick="exportarChecklist()">Descargar Checklists</button>

    <div id="log">Esperando acciones...</div>

    <script>
        function ejecutar(tipo) {
            document.getElementById('log').innerText = `⏳ Ejecutando ${tipo}...`;

            fetch(`/ejecutar/${tipo}`)
                .then(res => res.text())
                .then(msg => {
                    document.getElementById('log').innerText = msg;
                })
                .catch(() => {
                    document.getElementById('log').innerText = '❌ Error ejecutando el proceso.';
                });
        }

        function exportarChecklist() {
            const fecha = document.getElementById('fechaChecklist').value;
            const desde = document.getElementById('fechaDesde').value;
            const hasta = document.getElementById('fechaHasta').value;

            let url = '/ejecutar/checklist?';

            if (desde && hasta) {
                url += `desde=${desde}&hasta=${hasta}`;
            } else if (fecha) {
                url += `fecha=${fecha}`;
            } else {
                document.getElementById('log').innerText = '⚠️ Seleccioná una fecha o un rango antes de exportar.';
                return;
            }

            document.getElementById('log').innerText = '⏳ Exportando checklists...';

            fetch(url)
                .then(res => res.text())
                .then(msg => {
                    document.getElementById('log').innerText = msg;
                })
                .catch(() => {
                    document.getElementById('log').innerText = '❌ Error ejecutando el proceso.';
                });
        }
    </script>

</body>
</html>
